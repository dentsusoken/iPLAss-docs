[[AdminConsole_Product_BulkUpdate]]
=== 一括更新画面

==== 設定方法

GEMモジュールで作成された管理画面に独自のカスタムテンプレートを組み込むことが可能です。 +
マネージャーまたはオペレーターに属するユーザーが、商品の在庫状況を一括更新できる機能を例として説明します。

* Commandの定義
+
在庫一括表示用Commandクラス
+
[cols="1,2"]
|===
h|ファイル名|src/main/java/samples/ec01/command/backoffice/stock/StockBulkViewCommand.java
|===
+
[source,java]
----
@ActionMapping(
		name = "samples/ec01/backoffice/stock/stockUpdate", <1>
		displayName = "在庫一括表示", 
		privileged = false, <2>
		result = @Result(
				type = Type.TEMPLATE, 
				value = "samples/ec01/backoffice/stock/stockUpdate"
		))
@CommandClass(
		name = "samples/ec01/backoffice/stock/StockBulkViewCommand", 
		displayName = "在庫一括表示コマンド")
public class StockBulkViewCommand implements Command {
----------------------------------------以下略----------------------------------------
----
<1> 在庫一括表示用Action
<2> 特権実行モードをfalseに指定します。
+
在庫一括更新用Commandクラス
+
[cols="1,2"]
|===
h|ファイル名|src/main/java/samples/ec01/command/backoffice/stock/StockBulkUpdateCommand.java
|===
+
[source,Java]
----
@ActionMapping( 
		name = "samples/ec01/backoffice/stock/doStockUpdate",  <1>
		displayName = "在庫一括更新", 
		privileged = false, <2>
		result = @Result(
				type = Type.TEMPLATE, 
				value = "samples/ec01/backoffice/stock/stockUpdate"))
@CommandClass(
		name = "samples/ec01/backoffice/stock/StockBulkUpdateCommand", 
		displayName = "在庫一括更新コマンド")
public class StockBulkUpdateCommand implements Command {

	private final String RESULT_PRODUCT_LIST = "productList";

	@Override
	public String execute(RequestContext request) {
----------------------------------------以下略----------------------------------------
----
<1> 在庫一括更新用Action
<2> 特権実行モードをfalseに指定します。

* Template定義
** JSPを利用してテンプレートを作成します。
+
[cols="1,2"]
|===
h|ファイル名|src/main/webapp/jsp/samples/ec01/backOffice/stock/stockUpdate.jsp
|===

** レイアウトテンプレートを指定します。
+
[cols="1,2"]
|===
h|ファイル名|src/main/resources/samples-ec01-ce-metadata.xml
|===
+
[source,xml]
----
	<!-- Backoffice pages start -->
	<metaDataEntry>
		<metaData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			xsi:type="metaJspTemplate">
			<name>samples/ec01/backoffice/stock/stockUpdate</name>
			<displayName>在庫一括更新画面</displayName>
			<path>/jsp/samples/ec01/backOffice/stock/stockUpdate.jsp</path>
			<layoutId>/action/gem/layout/defaultLayout</layoutId> <1>
			<contentType>text/html; charset=utf-8</contentType>
		</metaData>
	</metaDataEntry>
	<!-- Backoffice pages end -->
----
<1> 利用するレイアウトテンプレートに管理画面用の標準レイアウトを指定します。

* Topメニュー画面
** 一括更新画面を表示するアクションメニューアイテムを新規作成します。
+
image::images/sample-ec_adminconsole-bulkupdate-actionmenu.png[align=left]
. 在庫一括表示用Actionクラスを指定します。

** 作成したアクションメニューアイテムをマネージャーとオペレーター用のメニューに組み込みます。
+
image::images/sample-ec_adminconsole-bulkupdate-topmenu.png[align=left]
. マネージャーに属するユーザー用のメニュー定義 + 
. マネージャーに属するユーザー用のメニュー定義に在庫一括表示用アクションメニューアイテムを組み込みます。

==== 画面表示

image::images/sample-ec_adminconsole-bulkupdate-update.png[align=left]

. EC商品管理メニューを開き、「在庫一括更新」をクリックします。
. 更新したい商品の在庫数を入力して、「一括更新」ボタンをクリックします。
